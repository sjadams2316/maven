# 2026-02-08 Session Notes

## GitHub Setup
- Connected workspace to GitHub: https://github.com/sjadams2316/maven
- Created Personal Access Token with repo scope
- Cleaned up node_modules and API keys from git history
- Configured git identity as "Sam Adams"

## UI Polish
- **Glowing Oracle Ball**: Added breathing/pulsing animation to floating chat button
  - 3-second animation cycle
  - Purple glow radiates outward (box-shadow layers)
  - Subtle scale pulse (1.0 â†’ 1.05)
  - Changed icon to ðŸ”® crystal ball

- **Reorganized Dashboard Tools**:
  - **Primary Tools** (5 visible): Oracle, Portfolio Lab, Fragility Index, Tax-Loss Harvester, Financial Snapshot
  - **Additional Tools** (collapsible, 8 more): Social Security, Retirement Optimizer, What-If Scenarios, Roth Converter, Rebalancing, Risk Analysis, Link Accounts, Collaborative Planning
  - Market Fragility Index promoted to Primary per Sam's feedback

## Business Strategy: Maven Tiering
Created `maven/docs/TIERING.md` defining three tiers:

1. **Maven Basic** (Free)
   - Top of funnel, lead gen
   - Limited features, manual entry only
   
2. **Maven Pro** ($29-49/month)
   - DIY investors who want tools
   - Full features, Plaid linking
   - Conversion funnel to Partners
   
3. **Maven Partners** (Included in AUM)
   - **This is the business** â€” RIA clients
   - Schwab direct link, advisor curation
   - White-glove onboarding with welcome card
   - "You see everything, they see what you want"

Key innovation: **Advisor-controlled UX** â€” advisors can curate which insights clients see (show/hide/contextualize). Solves the "client sees scary risk" problem.

Morgan Stanley / E*Trade comp: Pro users are a prospecting funnel that converts to Partners when life events happen.

## Advisor Dashboard (MAJOR BUILD)
Built complete advisor control plane at `/advisor`:

### Pages Created:
1. **`/advisor`** - Advisor home
2. **`/advisor/clients`** - Client list
3. **`/advisor/clients/[id]`** - Client detail with 5 tabs
4. **`/advisor/clients/[id]/prep`** - Meeting prep
5. **`/advisor/insights`** - Global insights view
6. **`/advisor/settings`** - Firm settings
7. **`/advisor/analytics`** - Practice analytics
8. **`/advisor/clients/invite`** - Client invite flow

## Morning Build Session

**Client Flow:**
- `/join/[code]` - Partner onboarding

**User Features:**
- `/goals` â€” Financial goals tracker
- `/family` â€” Multi-generational dashboard
- `/crypto` â€” Crypto holdings with live data
- `/documents` â€” Document vault
- `/accounts/link` â€” Plaid-style account linking
- `/home` â€” Marketing landing page
- `/onboarding` â€” 5-step new user flow
- `/settings`, `/notifications`, `/activity`, `/billing`, `/refer`, `/changelog`
- Tax planning, income tracker, spending tracker, estate planning, insurance
- Mobile nav, quick actions

---

## Afternoon Build Session (12:00+ EST)

Built 12 more pages:

### Compliance & Regulatory:
- `/compliance` â€” Compliance task tracker (agreements, questionnaires, reviews, disclosures, audit log)
- `/compliance/questionnaire` â€” Interactive risk tolerance questionnaire with scoring and suggested allocation

### Portfolio Management:
- `/performance` â€” Performance attribution (returns by holding, factor attribution, alpha analysis, risk metrics)
- `/rebalance` â€” Full rebalancing tool (drift detection, tax-aware mode, trade preview, model portfolios)
- `/benchmarks` â€” Compare portfolio vs SPY, VTI, QQQ, bonds, Bitcoin with alpha calculations
- `/trade` â€” Trade center (order ticket, positions, open orders, recent fills)

### Tax & Planning:
- `/asset-location` â€” Asset location optimizer (tax drag analysis, optimal placement recommendations)
- `/monte-carlo` â€” Monte Carlo retirement simulator (1,000+ scenarios, success rate, fan chart)
- `/income` â€” Income planner (dividend/interest/SS/pension tracking, retirement income projections)

### Alerts & Reports:
- `/alerts` â€” Alert center (fragility, drift, tax, earnings, dividends, compliance alerts)
- `/alerts/settings` â€” Configure alert thresholds, channels (email/push/SMS), quiet hours, price alerts
- `/reports` â€” Report generator (performance, holdings, tax, client review, risk, ESG templates)

**Total new code:** ~150KB across 12 pages

---

## Evening Build Session - Monte Carlo Deep Upgrade

Sam asked me to make the Monte Carlo "the most accurate tool out there" with continuous upgrades. Built a production-grade system:

### Historical Data Layer (`/lib/historical-returns.ts`)
- 97 years of S&P 500 annual returns (1928-2024)
- 10-Year Treasury Bond returns (1928-2024)
- International (EAFE) returns (1970-2024)
- Gold returns (1972-2024)
- REIT returns (1972-2024)
- Bitcoin returns (2011-2024)
- CPI inflation rates (1928-2024)
- **Correlation matrix** between all asset classes
- Historical drawdown periods

### Monte Carlo Engine (`/lib/monte-carlo-engine.ts`)
- **Bootstrap sampling** from actual historical returns (not random normal)
- **Fat-tailed distributions** using Student's t-distribution for crash scenarios
- **Correlation-aware** multi-asset simulation
- Multiple withdrawal strategies (fixed, flexible, guardrails)
- Glide path allocation adjustment over time
- Social Security integration
- Basic tax modeling (RMD, qualified vs non-qualified)
- 1,000+ simulation runs per analysis

### Stress Test System (`/lib/stress-test-scenarios.ts`)
Historical crisis scenarios with actual asset class returns:
- Global Financial Crisis (2007-2009)
- COVID-19 Crash (2020)
- Dot-Com Crash (2000-2002)
- 2022 Bear Market
- Black Monday 1987
- 1973-74 Oil Crisis
- Euro Debt Crisis (2011)
- 1994 Rising Rates

### Safe Withdrawal Rate Calculator (`/lib/safe-withdrawal.ts`)
- Historical SWR analysis across all 97 years
- Multiple withdrawal strategies (Fixed, Guardrails, RMD-style, Floor/Ceiling)
- **Sequence of returns risk** visualization
- Worst/best case historical periods identification

### Valuation Indicators (`/lib/valuation-indicators.ts`)
- CAPE ratio historical data and projections
- Buffett Indicator (Market Cap to GDP)
- Fed Model (earnings yield vs treasury)
- Expected return estimation from valuations
- Market outlook generator

### New Pages:
- `/stress-test` â€” Historical crisis impact analysis
- `/safe-withdrawal` â€” SWR calculator with sequence risk
- `/monte-carlo` â€” Upgraded with real historical data

### API Endpoints:
- `/api/historical-returns` â€” Fetches live data from FRED
- `/api/monte-carlo` â€” Runs simulations server-side
- `/api/valuations` â€” Current market valuation indicators

### Commits:
- `1b17978` - Major Monte Carlo upgrade (historical bootstrap, fat tails, correlation, stress testing)
- `35e8b36` - Safe Withdrawal Rate calculator with sequence risk

### Still TODO:
- Integrate valuation data into Monte Carlo expected returns
- Market Outlook page using valuation indicators
- Real-time data refresh for historical returns
- Sensitivity analysis visualization

## Bug Fixes

### Oracle Claude Integration
- **Issue:** Oracle sometimes falls back to generic responses
- **Root cause:** Missing `ANTHROPIC_API_KEY` in `.env.local`
- **Fix:** Added placeholder in .env.local, updated fallback to clearly indicate when in fallback mode, updated UI to say "Powered by Claude"
- **Action needed:** Sam needs to add his Anthropic API key to `maven/apps/dashboard/.env.local`

### Bitcoin Price
- **Issue:** Sam thought BTC price was incorrect/hardcoded
- **Reality:** BTC price IS live from Polygon API â€” $69,289 is the actual current price
- Data sources confirmed working: Yahoo (indices), Polygon/CoinGecko (crypto)

---

## Git Commits Today
- Initial morning commits (from previous session)
- "Add 12 new pages: compliance, risk questionnaire, performance attribution, rebalance, benchmarks, trade center, asset location, monte carlo, income planner, alerts + settings, reports"

## Total Pages Built: 36+ pages
## Total Lines of Code: ~15,000+

ðŸš€ðŸš€ðŸš€ Massive build weekend
